<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600" width="900" height="600">
  <!-- Background -->
  <rect width="900" height="600" fill="#fafafa"/>

  <!-- Title -->
  <text x="450" y="30" font-family="Georgia, serif" font-size="18" text-anchor="middle" fill="#4a4a4a">
    Time Series Metric Selection Decision Tree
  </text>

  <!-- Start node -->
  <ellipse cx="450" cy="75" rx="80" ry="25" fill="#4a4a4a" opacity="0.8"/>
  <text x="450" y="80" font-family="Georgia, serif" font-size="12" text-anchor="middle" fill="white">
    Start: Choose Metric
  </text>

  <!-- Decision 1: High Persistence? -->
  <rect x="350" y="130" width="200" height="50" fill="none" stroke="#4a4a4a" stroke-width="1.5" rx="5"/>
  <text x="450" y="150" font-family="Georgia, serif" font-size="11" text-anchor="middle" fill="#4a4a4a">
    Is ACF(1) &gt; 0.9?
  </text>
  <text x="450" y="165" font-family="Georgia, serif" font-size="10" text-anchor="middle" fill="#666666">
    (High persistence)
  </text>

  <!-- Arrow from Start to Decision 1 -->
  <line x1="450" y1="100" x2="450" y2="130" stroke="#666666" stroke-width="1"/>

  <!-- YES branch from Decision 1 -->
  <line x1="350" y1="155" x2="200" y2="155" stroke="#55a868" stroke-width="1.5"/>
  <line x1="200" y1="155" x2="200" y2="230" stroke="#55a868" stroke-width="1.5"/>
  <text x="270" y="145" font-family="Georgia, serif" font-size="10" fill="#55a868">YES</text>

  <!-- MASE recommendation box -->
  <rect x="100" y="230" width="200" height="80" fill="#55a868" opacity="0.15" stroke="#55a868" stroke-width="1.5" rx="5"/>
  <text x="200" y="255" font-family="Georgia, serif" font-size="12" text-anchor="middle" fill="#55a868" font-weight="bold">
    Use MASE
  </text>
  <text x="200" y="275" font-family="Georgia, serif" font-size="10" text-anchor="middle" fill="#4a4a4a">
    Mean Absolute Scaled Error
  </text>
  <text x="200" y="295" font-family="Georgia, serif" font-size="9" text-anchor="middle" fill="#666666">
    MASE &lt; 1 = beats naive baseline
  </text>

  <!-- NO branch from Decision 1 -->
  <line x1="550" y1="155" x2="700" y2="155" stroke="#c44e52" stroke-width="1.5"/>
  <line x1="700" y1="155" x2="700" y2="230" stroke="#c44e52" stroke-width="1.5"/>
  <text x="630" y="145" font-family="Georgia, serif" font-size="10" fill="#c44e52">NO</text>

  <!-- Decision 2: Directional matters? -->
  <rect x="600" y="230" width="200" height="50" fill="none" stroke="#4a4a4a" stroke-width="1.5" rx="5"/>
  <text x="700" y="250" font-family="Georgia, serif" font-size="11" text-anchor="middle" fill="#4a4a4a">
    Direction matters?
  </text>
  <text x="700" y="265" font-family="Georgia, serif" font-size="10" text-anchor="middle" fill="#666666">
    (e.g., trading signals)
  </text>

  <!-- YES branch from Decision 2 -->
  <line x1="600" y1="255" x2="500" y2="255" stroke="#55a868" stroke-width="1.5"/>
  <line x1="500" y1="255" x2="500" y2="330" stroke="#55a868" stroke-width="1.5"/>
  <text x="545" y="245" font-family="Georgia, serif" font-size="10" fill="#55a868">YES</text>

  <!-- PT Test recommendation -->
  <rect x="400" y="330" width="200" height="80" fill="#dd8452" opacity="0.15" stroke="#dd8452" stroke-width="1.5" rx="5"/>
  <text x="500" y="355" font-family="Georgia, serif" font-size="12" text-anchor="middle" fill="#dd8452" font-weight="bold">
    Use PT Test + Directional Acc
  </text>
  <text x="500" y="375" font-family="Georgia, serif" font-size="10" text-anchor="middle" fill="#4a4a4a">
    Pesaran-Timmermann test
  </text>
  <text x="500" y="395" font-family="Georgia, serif" font-size="9" text-anchor="middle" fill="#666666">
    Tests if direction beats 50% coin flip
  </text>

  <!-- NO branch from Decision 2 -->
  <line x1="800" y1="255" x2="850" y2="255" stroke="#c44e52" stroke-width="1.5"/>
  <line x1="850" y1="255" x2="850" y2="330" stroke="#c44e52" stroke-width="1.5"/>
  <line x1="850" y1="330" x2="700" y2="330" stroke="#c44e52" stroke-width="1.5"/>
  <text x="820" y="245" font-family="Georgia, serif" font-size="10" fill="#c44e52">NO</text>

  <!-- Decision 3: Comparing models? -->
  <rect x="600" y="330" width="200" height="50" fill="none" stroke="#4a4a4a" stroke-width="1.5" rx="5"/>
  <text x="700" y="350" font-family="Georgia, serif" font-size="11" text-anchor="middle" fill="#4a4a4a">
    Comparing two models?
  </text>
  <text x="700" y="365" font-family="Georgia, serif" font-size="10" text-anchor="middle" fill="#666666">
    (Statistical significance)
  </text>

  <!-- YES from Decision 3 - splits to nested check -->
  <line x1="700" y1="380" x2="700" y2="420" stroke="#55a868" stroke-width="1.5"/>
  <text x="710" y="405" font-family="Georgia, serif" font-size="10" fill="#55a868">YES</text>

  <!-- Decision 4: Nested models? -->
  <rect x="600" y="420" width="200" height="50" fill="none" stroke="#4a4a4a" stroke-width="1.5" rx="5"/>
  <text x="700" y="440" font-family="Georgia, serif" font-size="11" text-anchor="middle" fill="#4a4a4a">
    Models nested?
  </text>
  <text x="700" y="455" font-family="Georgia, serif" font-size="10" text-anchor="middle" fill="#666666">
    (One is special case)
  </text>

  <!-- YES - CW Test -->
  <line x1="600" y1="445" x2="450" y2="445" stroke="#55a868" stroke-width="1.5"/>
  <line x1="450" y1="445" x2="450" y2="500" stroke="#55a868" stroke-width="1.5"/>
  <text x="520" y="435" font-family="Georgia, serif" font-size="10" fill="#55a868">YES</text>

  <rect x="350" y="500" width="200" height="65" fill="#1f77b4" opacity="0.15" stroke="#1f77b4" stroke-width="1.5" rx="5"/>
  <text x="450" y="525" font-family="Georgia, serif" font-size="12" text-anchor="middle" fill="#1f77b4" font-weight="bold">
    Use CW Test
  </text>
  <text x="450" y="545" font-family="Georgia, serif" font-size="10" text-anchor="middle" fill="#4a4a4a">
    Clark-West adjustment for nested
  </text>

  <!-- NO - DM Test -->
  <line x1="800" y1="445" x2="850" y2="445" stroke="#c44e52" stroke-width="1.5"/>
  <line x1="850" y1="445" x2="850" y2="500" stroke="#c44e52" stroke-width="1.5"/>
  <line x1="850" y1="500" x2="700" y2="500" stroke="#c44e52" stroke-width="1.5"/>
  <text x="820" y="435" font-family="Georgia, serif" font-size="10" fill="#c44e52">NO</text>

  <rect x="600" y="500" width="200" height="65" fill="#8c564b" opacity="0.15" stroke="#8c564b" stroke-width="1.5" rx="5"/>
  <text x="700" y="525" font-family="Georgia, serif" font-size="12" text-anchor="middle" fill="#8c564b" font-weight="bold">
    Use DM Test
  </text>
  <text x="700" y="545" font-family="Georgia, serif" font-size="10" text-anchor="middle" fill="#4a4a4a">
    Diebold-Mariano for non-nested
  </text>

  <!-- Default path: Just use MAE/RMSE -->
  <line x1="200" y1="155" x2="200" y2="380" stroke="#666666" stroke-width="1" stroke-dasharray="5,3"/>
  <line x1="200" y1="380" x2="200" y2="500" stroke="#666666" stroke-width="1"/>

  <rect x="100" y="500" width="200" height="65" fill="#7f7f7f" opacity="0.15" stroke="#7f7f7f" stroke-width="1.5" rx="5"/>
  <text x="200" y="520" font-family="Georgia, serif" font-size="12" text-anchor="middle" fill="#7f7f7f" font-weight="bold">
    Default: MAE / RMSE
  </text>
  <text x="200" y="540" font-family="Georgia, serif" font-size="10" text-anchor="middle" fill="#4a4a4a">
    Always compare to baseline
  </text>
  <text x="200" y="555" font-family="Georgia, serif" font-size="9" text-anchor="middle" fill="#666666">
    (persistence or seasonal naive)
  </text>

  <!-- Footnote -->
  <text x="450" y="590" font-family="Georgia, serif" font-size="9" text-anchor="middle" fill="#8a8a8a" font-style="italic">
    All tests available in temporalcv.statistical_tests
  </text>
</svg>
